# 3/12

0-0 安装虚拟机

寒假装过，省的折腾了

0-1 git

查了提交仓库链接怎么做

0-2 Parsing parameters 

约定文档好长的洋文 没看完

查了一下getopt，试着配置了-v和-h 复杂的配置也还没看

# 3/13

0-3  Video decoder

下载安装没问题，但是后面遇到了麻烦

开始是直接include .h文件，报错之后才想到有.a文件的配置问题

翻到一篇文章，大概了解了.a文件的调用，还有一些项目的规范

使用`-I`（大写的字母`i`）选项指明头文件的包含路径，使用`-L`选项指明静态库的包含路径，使用`-l`（小写字母`L`）选项指明静态库的名字

1-1 Image print

灰度图红绿蓝三原色分量相等

通过data返回rgb值，再打印

ESC[ … 38;2;<r>;<g>;<b> … m 前景

ESC[ … 48;2;<r>;<g>;<b> … m 背景

写出来的代码打印的视频完全不对啊 一块和原视频相同的地方都没有啊 明天再说吧

# 3/14 

居然是width打错了

长宽比问题：想办法设置字体等长高->设置里width拉到2.0还是不够->搜索如何处理行间距过大问题 似乎可以下Alacritty 插件/重装ubuntu退版本/换英文 于是选了最简单的一个

灰度问题：我是用r=g=b=(r+g+b)/3直接打的，也看到有别的计算公式 

打印效率要怎么判断呢，也许可以通过方块的密集度来控制灰度？ 不是很懂

拓展任务感觉能做 先放着

1-2 Downsample

```
(nh - f + 1) / s x (nw - f + 1)/s x nc
```

pooling有一种滤波的既视感，好怀念

提升帧的分辨率：查到了图像超分辨率重建算法

# 3/15

average_pooling的效果很差，也许是我代码的问题

max_pooling效果还算差强人意

1-3 Video player

打印帧的代码加上循环和时间间隔就能打印视频了

通过clear命令清屏，但打印速度还是跟不上

拓展任务

int getopt(int argc, char * const argv[], const char *optstring);

第一个参数argc是参数个数，和main函数的argc一样；

第二个参数argv是字符串指针，和main函数的argv一样；

感觉把“不合法输入”写在default会出错，果真如此

然后发现原来getopt自带异常处理啊。。。

2-1 Multithreading

pthread_cond_wait 和 pthread_cond_signal使两个线程交替访问全局变量

gcc居然可以直接写变长数组

但是变长数组又当不了全局变量，痛苦

1. "->"是在声明结构体指针时，访问结构体成员变量时使用。
2. "."是声明结构体时，访问结构体成员变量时使用。

# 3/16

翻了pthread的文档和网上的代码，差不多把多线程写了一下

疑问：如果是按照“resize->锁resize->print->锁print”的线程进行的话，和一个线程里先resize再print有什么区别呢

内存越界了，应该是我buffer初始化的时候有问题，先用一个大数组代替data，别的办法后面再说

似乎是两个线程自锁了

int pthread_create(pthread_t* restrict tidp,const pthread_attr_t* restrict_attr,void* (*start_rtn)(void*),void *restrict arg);

pthread_create参数类型是void*，多参数的函数需要用一个结构体来传参

还是segmentation fault 折腾了一天累了先放着吧。。。

# 3/17

2-2 Optimization

CSI `n` ; `m` H CUP – 光标位置（Cursor Position）

新建了一个数组来记录上一次打印的数据，从而进行比较

不知道有没有直接通过光标读取数据的办法

出现了难以名状的画面，应该是因为

CSI `n` C 光标向指定的方向移动n（默认1)格。如果光标已在屏幕边缘，则无效。

翻译的文章把right翻成后left翻成前害我搞半天。。

遇到了一个困扰许久的难题，记录一下吧

我的思路是通过printf("\033[H")使光标回到开头，再从头开始打印

但是我发现在打印视频的时候，理论上应该是每次打印都能正好覆盖上一次，从而实现类似清屏再重新打印的效果，但实际上每次打印都会和上一次形成一定的偏差，就像光标没有移动到第一行开头而是移动到了第n行一样。

最后试了很久打印的方法才发现，如果我的打印超出了终端在屏幕上显示的行数（就是一张图片在终端上放不下），这时候调用\033[H就只能使指针回到屏幕的左上角而不是整个终端的左上角，因此导致了打印的偏差

# 3/18

3-1 Pause  3-2 Accelerate

可以用kbhit，但需要conio.h，在github上找到了一个自制的.h文件但是安装后出现了错误，就先放着了（我试着看了一下但是这个报错真的让我摸不着头脑，issues里也没人问过）

通过select检查stdin：在所有的文件描述符中有两个比较特殊的存在：0、1，其实stdin == 0，stdout == 1，所以我们可以将0设置为select要监听的文件描述符

最后是抄的代码，他怎么实现kbhit（）的还在看

整理一下~~抄~~用到的资料吧

1.git

[在 GitHub Docs 上使用 Git - GitHub 文档](https://docs.github.com/zh/contributing/collaborating-on-github-docs/using-git-on-github-docs)

[Git 教程 | 菜鸟教程 (runoob.com)](https://www.runoob.com/git/git-tutorial.html)

2.getopt

[浅谈linux的命令行解析参数之getopt_long函数-CSDN博客](https://blog.csdn.net/qq_33850438/article/details/80172275)

3.静态库

[GCC创建和使用静态链接库（.a文件） (biancheng.net)](https://c.biancheng.net/view/7168.html)

4.ansi

[ANSI最全介绍linux终端字体改变颜色等 - 苏鑫2017的博客 - 博客园 (cnblogs.com)](https://www.cnblogs.com/qxhn/p/10984364.html#转义序列)

[ANSI Escape Codes (github.com)](https://gist.github.com/fnky/458719343aabd01cfb17a3a4f7296797)

5.terminal行间距

[新版 Ubuntu 中 gnome-terminal 可恶的行间距问题逼我退回了 Ubuntu 20.04 - 京山游侠 - 博客园 (cnblogs.com)](https://www.cnblogs.com/youxia/p/linux040.html)

6.多线程

[pthread_create函数详解（向线程函数传递参数）-CSDN博客](https://blog.csdn.net/mijichui2153/article/details/82855925)

[C语言学习之线程同步——mutex锁、条件变量_c语言条件变量-CSDN博客](https://blog.csdn.net/u013511885/article/details/103110262)

[Linux 下 segmentation fault(段错误) 总结 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/205579221)

7.非阻塞键盘输入

[zoelabbb/conio.h: This is a library conio.h for linux 🖥️. you can install manual library conio.h for linux step by step here. (github.com)](https://github.com/zoelabbb/conio.h)

[利用select监听stdin输入_window stdinselect-CSDN博客](https://blog.csdn.net/qq_32685139/article/details/53769405)

[在linux下面实现检测按键（Linux中kbhit（）函数的实现）_linux c++ 检测 组合按键-CSDN博客](https://blog.csdn.net/lxh1230119/article/details/7784914)
